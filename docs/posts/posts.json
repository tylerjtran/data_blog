[
  {
    "path": "posts/2021-01-24-what-does-housing-look-like-in-different-philly-neighborhoods/",
    "title": "What does housing look like in different Philly neighborhoods?",
    "description": "A look at what residential buildings look like across Philadelphia, from detached single family homes to multi-unit high-rise apartments.",
    "author": [
      {
        "name": "Tyler Tran",
        "url": {}
      }
    ],
    "date": "2019-03-02",
    "categories": [],
    "contents": "\r\nA few years back, the Washington Post published a visualization of Census data showing differences in housing in different large cities across the US. This was updated by Munson’s City, and both reports show the stunning abundance of single-family housing in American cities. Nationally, more than 60% of housing is detached single-family housing, and in more than half of the 50 largest US cities, single-family housing prevails as the dominant home type.\r\nWhile cities such as New York and Boston are mostly made up of multi-family housing (in both cities, less than 20% of housing is single-family), data from Philadelphia show that it is truly a city of rowhomes. Philly and Baltimore are the only two cities analyzed with a majority of housing being single-family attached, or rowhomes. A prevalence of single-family housing in cities has implications in housing affordability, and many point to a lack of mid-density housing (or, the “Missing Middle”) as a threat to walkability and affordability.\r\nRecognizing Philly as an outlier in the WaPo article, I decided to take a closer look at Philadelphia housing at the neighborhood scale. I re-created their visualization using US Census Bureau American Community Survey (2015-2019) data with Azavea’s definitions of Philly neighborhoods (though I realize these boundaries might be fluid and/or questionable to some). In the figure below, I show the 20 neighborhoods with the least single-family housing and the 20 neighborhoods with the most single-family housing. In between these two groups of extremes, you’ll find citywide numbers where, according to the most recent ACS numbers, about 65% of housing is single-family housing (but a relatively dense stock of single-family housing!).\r\n\r\n\r\nShow code\r\n\r\n# Housing type\r\n# Jan 2021 -- Re-writing code from March 2019\r\n\r\nlibrary(tidyverse); library(sf); library(tidycensus); library(showtext)\r\n\r\n#########################################################################\r\n# Set up fonts\r\n\r\nfont_add_google('Merriweather')\r\nfont_add_google('Source Sans Pro', 'ssp')\r\n\r\nshowtext_auto()\r\n\r\nfont_theme <- theme(\r\n  plot.title = element_text(family = 'Merriweather', face = 'bold'),\r\n  plot.subtitle = element_text(family = 'ssp'),\r\n  axis.text = element_text(family = 'ssp'),\r\n  axis.title = element_text(family = 'ssp'),\r\n  legend.text = element_text(family = 'ssp'),\r\n  plot.caption = element_text(family = 'ssp', color = 'darkgray')\r\n)\r\n#########################################################################\r\n\r\n\r\ncensus_api_key(Sys.getenv('census_api'))\r\n\r\n\r\n# Get Azavea neighborhoods\r\nneighborhoods <- st_read('https://raw.githubusercontent.com/azavea/geo-data/master/Neighborhoods_Philadelphia/Neighborhoods_Philadelphia.geojson')\r\n\r\n\r\n# Get housing type data from ACS\r\nhousing_type <- get_acs(geography = 'block group',\r\n                        table = 'B25024',\r\n                        state = 'PA',\r\n                        county = 'Philadelphia',\r\n                        year = 2019,\r\n                        geometry = T) %>%\r\n  mutate(label = case_when(\r\n    variable == 'B25024_001' ~ 'Total',\r\n    variable == 'B25024_002' ~ 'Single family detached',\r\n    variable == 'B25024_003' ~ 'Single family attached',\r\n    variable == 'B25024_004' ~ '2 units',\r\n    variable %in% c('B25024_005', 'B25024_006') ~ '3 to 9 units',\r\n    variable == 'B25024_007' ~ '10 to 19 units',\r\n    variable == 'B25024_008' ~ '20 to 49 units',\r\n    variable == 'B25024_009' ~ '50+ units',\r\n    variable == 'B25024_010' ~ 'Other'\r\n  )) %>%\r\n  st_transform(crs = st_crs(neighborhoods)) %>%\r\n  st_join(neighborhoods, join = st_intersects) %>%\r\n  group_by(mapname) %>%\r\n  summarise(n = sum(estimate[label == 'Total'], na.rm = T),\r\n            `Single family detached` = sum(estimate[label == 'Single family detached'], na.rm = T)/n,\r\n            `Single family attached` = sum(estimate[label == 'Single family attached'], na.rm = T)/n,\r\n            `2 units` = sum(estimate[label == '2 units'], na.rm = T)/n,\r\n            `3 to 9 units` = sum(estimate[label == '3 to 9 units'], na.rm = T)/n,\r\n            `10 to 19 units` = sum(estimate[label == '10 to 19 units'], na.rm = T)/n,\r\n            `20 to 49 units` = sum(estimate[label == '20 to 49 units'], na.rm = T)/n,\r\n            `50+ units` = sum(estimate[label == '50+ units'], na.rm = T)/n,\r\n            Other = sum(estimate[label == 'Other'], na.rm = T)/n) %>%\r\n  as_tibble() %>%\r\n  mutate(total_p_sfh = `Single family detached` + `Single family attached`)\r\n\r\n\r\nsfh_20_most <- housing_type %>%\r\n  top_n(20, total_p_sfh)\r\n\r\nsfh_20_least <- housing_type %>%\r\n  top_n(-20, total_p_sfh)\r\n\r\ncitywide <- get_acs(geography = 'county',\r\n                    table = 'B25024',\r\n                    state = 'PA',\r\n                    county = 'Philadelphia',\r\n                    year = 2019) %>%\r\n  mutate(label = case_when(\r\n    variable == 'B25024_001' ~ 'Total',\r\n    variable == 'B25024_002' ~ 'Single family detached',\r\n    variable == 'B25024_003' ~ 'Single family attached',\r\n    variable == 'B25024_004' ~ '2 units',\r\n    variable %in% c('B25024_005', 'B25024_006') ~ '3 to 9 units',\r\n    variable == 'B25024_007' ~ '10 to 19 units',\r\n    variable == 'B25024_008' ~ '20 to 49 units',\r\n    variable == 'B25024_009' ~ '50+ units',\r\n    variable == 'B25024_010' ~ 'Other'\r\n  )) %>%\r\n  summarise(mapname = 'Citywide',\r\n            n = sum(estimate[label == 'Total'], na.rm = T),\r\n            `Single family detached` = sum(estimate[label == 'Single family detached'], na.rm = T)/n,\r\n            `Single family attached` = sum(estimate[label == 'Single family attached'], na.rm = T)/n,\r\n            `2 units` = sum(estimate[label == '2 units'], na.rm = T)/n,\r\n            `3 to 9 units` = sum(estimate[label == '3 to 9 units'], na.rm = T)/n,\r\n            `10 to 19 units` = sum(estimate[label == '10 to 19 units'], na.rm = T)/n,\r\n            `20 to 49 units` = sum(estimate[label == '20 to 49 units'], na.rm = T)/n,\r\n            `50+ units` = sum(estimate[label == '50+ units'], na.rm = T)/n,\r\n            Other = sum(estimate[label == 'Other'], na.rm = T)/n) %>%\r\n  mutate(total_p_sfh = `Single family detached` + `Single family attached`)\r\n\r\n\r\np_housing_types <- bind_rows(\r\n  sfh_20_least,\r\n  sfh_20_most,\r\n  citywide\r\n) %>%\r\n  select(-n, -geometry) %>%\r\n  pivot_longer(c(-mapname, -total_p_sfh), names_to = 'category', values_to = 'p_category') %>%\r\n  mutate(category = factor(category, \r\n                           levels = rev(c('Single family detached', 'Single family attached',\r\n                                      '2 units', '3 to 9 units', '10 to 19 units',\r\n                                      '20 to 49 units', '50+ units', 'Other'))))\r\n\r\n# Kinda janky way to fix spacing in legend\r\n# https://stackoverflow.com/questions/50883294/increasing-whitespace-between-legend-items-in-ggplot2/50885122\r\nstr_pad_custom <- function(labels){\r\n  new_labels <- paste0(labels, '       ')\r\n  return(new_labels)\r\n}\r\n\r\nmy_palette <- rev(c('#e3ced3', '#aa82a8', '#6da18f', '#335b8e', \r\n                '#b7dbdb', '#faed55', '#687e4f', '#424242'))\r\nbold_citywide <- c(rep('plain', 20), 'bold.italic', rep('plain', 20))\r\n\r\n# Make plot of housing types by neighborhood\r\np_housing_types %>%\r\n  ggplot(aes(fill = category, y = p_category, x = reorder(mapname, -total_p_sfh))) +\r\n  geom_bar(position = 'stack', stat = 'identity') +\r\n  geom_hline(yintercept = c(0.25, 0.5, 0.75), linetype = 'dotted') +\r\n  geom_hline(yintercept = 0) +\r\n  labs(x = '', y = '', fill = '',\r\n       title = 'What does housing look like in different Philly neighborhoods?', \r\n       subtitle = 'Housing by Building Type',\r\n       caption = 'Source: ACS 2015-2019 5-year estimates') +\r\n  scale_y_continuous(expand = c(0, 0), breaks = c(0.25, 0.5, 0.75),\r\n                     labels = c('25%', '50%', '75%')) +\r\n  scale_fill_manual(values = my_palette, labels = str_pad_custom) +\r\n  coord_flip() +\r\n  theme(\r\n    legend.position = 'bottom',\r\n    plot.title = element_text(size = 15),\r\n    plot.subtitle = element_text(size = 13),\r\n    axis.text = element_text(size = 10.5),\r\n    axis.text.y = element_text(face = bold_citywide),\r\n    legend.spacing.x = unit(0.01, 'cm'),\r\n    axis.ticks.x = element_line(linetype = 'dotted'),\r\n    axis.ticks.y = element_blank(),\r\n    panel.background = element_blank(),\r\n    panel.grid = element_blank()\r\n  ) +\r\n  font_theme +\r\n  guides(fill = guide_legend(nrow = 1, reverse = T))\r\n\r\n\r\n\r\n\r\nIt’ll be interesting to take another look at this in a couple years, as I suspect data from some neighborhoods will reflect an emphasis on multi-family housing in development, and maybe some in the “missing middle.”\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-01-24-what-does-housing-look-like-in-different-philly-neighborhoods/what-does-housing-look-like-in-different-philly-neighborhoods_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2021-01-25T18:40:34-05:00",
    "input_file": {}
  }
]
